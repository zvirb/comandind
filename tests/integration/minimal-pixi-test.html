<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Minimal PixiJS CSP Test</title>
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline' 'wasm-unsafe-eval'; worker-src 'self' blob:; style-src 'self' 'unsafe-inline'; img-src 'self' data: blob:; connect-src 'self' ws: wss:; font-src 'self' data:;">
    <style>
        body { margin: 0; padding: 20px; background: #222; color: #fff; font-family: Arial, sans-serif; }
        #result { padding: 10px; margin: 10px 0; border-radius: 5px; }
        .success { background: #2d5a2d; }
        .error { background: #5a2d2d; }
    </style>
</head>
<body>
    <h1>Minimal PixiJS CSP Test</h1>
    <div id="result">Testing...</div>
    <div id="canvas-container"></div>

    <script type="module">
        // Import unsafe-eval FIRST, before PixiJS
        import '@pixi/unsafe-eval';
        
        // Then import PixiJS
        import { Application, Graphics } from './node_modules/pixi.js/dist/pixi.esm.js';
        
        const resultDiv = document.getElementById('result');
        const canvasContainer = document.getElementById('canvas-container');
        
        try {
            console.log('üîß Starting minimal PixiJS test...');
            
            // Create PixiJS application
            const app = new Application();
            
            console.log('üéÆ Initializing PixiJS application...');
            await app.init({
                width: 400,
                height: 300,
                backgroundColor: 0x1a1a1a
            });
            
            console.log('‚úÖ PixiJS initialized successfully!');
            resultDiv.innerHTML = '‚úÖ SUCCESS: PixiJS initialized without CSP errors!';
            resultDiv.className = 'success';
            
            // Add canvas to page
            canvasContainer.appendChild(app.canvas);
            
            // Test rendering
            const rect = new Graphics();
            rect.rect(10, 10, 100, 50);
            rect.fill(0x00ff00);
            app.stage.addChild(rect);
            
            console.log('üé® Graphics rendered successfully!');
            
        } catch (error) {
            console.error('‚ùå PixiJS test failed:', error);
            resultDiv.innerHTML = `‚ùå FAILED: ${error.message}`;
            resultDiv.className = 'error';
        }
    </script>
</body>
</html>